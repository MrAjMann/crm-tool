<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/css/output.css" rel="stylesheet" />
    <title>Data on the Downs - Invoices</title>
</head>
<body class="flex bg-gray-100 "> <!-- Black background with white text -->

    <div class="bg-gray-800 text-white w- space-y-6 py-7 px-2">
        <!-- Sidebar content -->
        {{template "sidebar.html"}}
    </div>

    <div class="flex-grow flex flex-col">
        <!-- TopBar -->
        <div class="bg-gray-800 text-white w-full">
        <div class="mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <h1 class="text-lg font-semibold">Invoices</h1>
            <div>
                <button
                    hx-get="/create-invoice-modal"
                    hx-trigger="click"
                    hx-target="#modal-container"
                    hx-swap="innerHTML"
                    class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
                >
                    Create Invoice
                </button>
                </div>
            </div>
         </div>
         <div id="modal-container" class="overlay"></div>
        <div class="container mx-auto p-4">
        <h1 class="text-3xl font-semibold mb-4">Invoices</h1> <!-- Simplified styling for clarity -->

        <!-- Search Form -->
        <div class="mb-4">
            <input type="text" hx-get="/search-invoices" hx-trigger="keyup delayed:500ms" hx-target="#invoice-table"
                   class="text-gray-800 border  w-full border-gray-200 outline-gray-400 shadow-md rounded-lg p-4 " placeholder="Search invoices..."
                   style="background-color: #f3f4f6; "> <!-- Dark input for subtle contrast -->
        </div>

       <!-- Invoice Table -->
<div id="invoice-table" class="shadow-md rounded-lg p-4">
    <table class="min-w-full leading-normal">
        <thead>
            <tr class="text-left text-sm font-semibold tracking-wider border-b border-gray-200">
                <th class="px-5 py-3">InvoiceId</th>
                <th class="px-5 py-3">Invoice Number</th>
                <th class="px-5 py-3">Date</th>
                <th class="px-5 py-3">Due Date</th>
                <th class="px-5 py-3">Customer Name</th>
                <th class="px-5 py-3">Company Name</th>
                <th class="px-5 py-3">Phone</th>
                <th class="px-5 py-3">Email</th>
                <th class="px-5 py-3">Payment Status</th>
                <th class="px-5 py-3">Actions</th>
            </tr>
        </thead>
        <tbody>
            {{ range .Invoices }}
            <tr class="bg-gray-100 border-b hover:bg-blue-500">
                <td class="px-5 py-5">{{ .InvoiceId }}</td>
                <td class="px-5 py-5">{{ .InvoiceNumber }}</td>
                <td class="px-5 py-5">{{ .InvoiceDate.Format "02/01/2006" }}</td>
                <td class="px-5 py-5">{{ .DueDate.Format "02/01/2006" }}</td>                
                <td class="px-5 py-5">{{ .CustomerName }}</td>
                <td class="px-5 py-5">{{ .CompanyName }}</td>
                <td class="px-5 py-5">{{ .CustomerPhone }}</td>
                <td class="px-5 py-5">{{ .CustomerEmail }}</td>
                <td class="px-5 py-5">{{ .PaymentStatus }}</td>
                <td class="px-5 py-5">
                    <a href="/invoice/view/{{ .InvoiceId }}" class="text-gray-800 hover:text-gray-100 transition duration-150 ease-in-out">View</a> |
                    <a href="/invoice/edit/{{ .InvoiceId }}" class="text-gray-800 hover:text-gray-100 transition duration-150 ease-in-out">Edit</a> |
                    <a href="/invoice/delete/{{ .InvoiceId }}" hx-delete="/invoice/delete/{{ .InvoiceId }}"
                    hx-confirm="Are you sure you want to delete this invoice?"
                    class="text-gray-800 hover:text-gray-100 transition duration-150 ease-in-out">Delete</a>
                </td>
            </tr>
            {{else}}
            <tr>
                <td colspan="9" class="text-center py-4">No invoices found.</td>
            </tr>
            {{ end }}
        </tbody>
    </table>
</div>

    </div>
    <script src="https://unpkg.com/htmx.org"></script>
    <script>
        function closeModal() {
            var modalContainer = document.getElementById("modal-container");
            if (modalContainer) {
                modalContainer.style.display = "none";
                modalContainer.innerHTML = ""; // Clear the modal content
            }
        }
    
        document.body.addEventListener("click", function (event) {
            if (event.target.matches(".close-modal")) {
                closeModal();
            }
        });
    
        document.body.addEventListener("htmx:afterSwap", function (event) {
            if (event.target.id === "modal-container") {
                var modalContainer = document.getElementById("modal-container");
                if (modalContainer) {
                    modalContainer.style.display = "block"; // Show modal when new content is loaded
                }
            }
        });
    </script>
</body>
</html>


